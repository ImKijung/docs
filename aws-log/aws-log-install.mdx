---
id: install-aws-log
title: 설치하기
description: 와탭 AWS Log 서비스 이용을 위한 기본 설치 방법을 안내합니다.
tags: [ AWS Log, 설치하기 ]
---
<!-- 
***관리*** > ***인티레이션 아이템*** 메뉴
프로젝트 생성 시 AWS Log 아이템을 설치하고 ***인티그레이션 아이템*** 메뉴에 진입하면 설치 화면이 나타납니다. 
-->
<!--
:::note 프로젝트 액세스 키
프로젝트 액세스 키가 없으면 설치 페이지로 이동할 수 없습니다. [프로젝트 액세스 키 확인](../aws-log/install-aws-log#check-accesskey) 단계로 돌아가 **프로젝트 액세스 키**를 발급받으세요.
:::
-->

{@include: ../getting-started/_how-to-start-intro.mdx}

## 프로젝트 생성

{@include: ../getting-started/_create-project-aws.mdx}

프로젝트를 생성한 후 ***관리*** > ***에이전트 설치*** 메뉴에서 아이템 설치가 가능합니다. 다음의 설치 안내를 참조해 진행하세요.

{@include: ../getting-started/_accesskey.mdx}

:::note 프로젝트 액세스 키
이미 **프로젝트 액세스 키**를 발급받았다면 버튼 대신 발급받은 키가 표시됩니다.
:::

<!-- 해당 설치 페이지 안내 이미지 삽입 예정 -->

## AWS Log 설치

1. 설치 페이지에서 ***AWS Log 설치*** 탭을 선택하세요. 
1. AWS Log를 설치할 리전을 선택하세요. 선택된 리전이 있으면 ***설치*** 버튼이 활성화됩니다.
1. ***설치*** 버튼을 클릭해 CloudFormation 페이지로 이동합니다. 기본 파라미터는 입력되어 있습니다. 페이지 하단으로 내려가 ***승인*** 체크 후 ***스택 생성*** 버튼을 클릭하세요.
![](/img/aws-log-cloudformation.png)
1. 설치가 완료되면 ***스택 메뉴*** > ***출력***에서 AWS Log Function ARN을 확인할 수 있습니다.<br/>
    ![](/img/aws-log-install-success.png)
    :::note AWS Log Function ARN
    AWS Log Function ARN으로 구독할 리소스를 조회하고 등록할 수 있습니다.
    :::
    :::note 설치 실패
    * 다음과 같은 에러 메시지가 발생한다면 권한 부여가 되어있는지 확인하세요.
    * 다음과 같은 에러 메시지가 발생한다면 CloudFormation 스택 이름을 변경하세요.
    :::    
1. 파라미터와 설치 IAM 권한에 대한 자세한 설명은 ***설치*** 버튼 아래 각 항목을 펼쳐 확인할 수 있습니다.
* 설치 파라미터 
    * Lambda 기본 설정  
|파라미터|기본값|설명|
|---|---|---|
|MemorySize|1024 (MB)|Lambda(Forwarder)의 메모리 사이즈를 설정합니다.|
|TimeOut|150 (s)|Lambda(Forwarder)의 Timeout시간. 즉, 로그 이벤트가 추가적으로 오지 않았을 때, Lambda가 내려가는 시간을 설정합니다.|
    * 장애 방지
* 필요 AWS IAM 권한


## IAM Role 생성

사용자가 직접 AWS IAM 서비스로 들어가 Role을 생성해야 합니다.

### IAM Role 정책 생성

IAM > 정책 > 정책 생성 페이지에서 다음의 정책을 생성하세요.
<!-- 임의로 dev guide 확인 후 삽입 ... 검토/수정 필요 -->

```json
{
"Version" : "2012-10-17",
"Statement": {
        "Effect" : "Allow",
        "Action" : [
            "s3:List",
            "s3:PutBucketNotification",
            "logs:PutSubscriptionFilter",
            "logs:DescribeLogGroups"
        ],
        "Resource": "*"
    }
}

```

:::note
누락된 정책이 있으면 설정이 정상적으로 이루어지지 않습니다.
:::

### IAM Role 생성

1. AWS Management Console에 로그인 후 IAM 콘솔을 여세요.
1. 콘솔 탐색창에서 역할을 선택한 후 역할 생성을 선택하세요.
1. Select type of trusted entity에서 AWS 계정을 선택하세요.
1. Account ID에 와탭 계정을 입력하고 ***다음***을 클릭하세요.
1. 기존 단계에서 만들었던 정책을 선택하세요.
1. Role의 이름과 설명을 입력하고 ***Create Role***을 선택하세요.
1. 생성된 Role의 ARN을 복사합니다.

## IAM Role ARN 및 리전 입력

리소스 조회를 위해 IAM Role ARN과 AWS Log가 설치된 리전을 입력하세요. 중간에 페이지를 이탈하지 않은 경우 **AWS Log 설치** 단계에서 입력한 리전이 자동으로 선택되어 있습니다.

1. IAM Role ARN을 입력하면 ***등록*** 버튼이 활성화됩니다. 버튼을 클릭하면 구독할 수 있는 리소스 목록을 조회합니다.
1. 조회 실패 시 다음과 같은 메시지가 나타납니다. ***확인*** 버튼을 선택하면 재시도할 수 있습니다.
<!--등록 실패 메시지-->
1. 조회 성공 시 성공 메시지가 나타나고, ***확인*** 버튼이 비활성화됩니다.
<!--등록 성공 메시지-->
<!-- ***등록*** 버튼을 다시 누르거나 이후 리소스 구독 단계에서 조회 목록 ***새로 고침***을 통해 재조회가 가능합니다. -->

## Log Forwarder가 지원하는 AWS Resource Log 확인

:::note
현재 지원 중인 리소스 로그 확인을 위한 참고 단계로 설치 과정에 영향을 주지 않습니다.
:::

## AWS Resource Log 선택 및 Subscribing

**IAM ROLE ARN 및 리전 입력** 단계에서 조회한 리소스 목록 중 구독할 리소스를 선택 및 등록하세요.

AWS Region, AWS Role ARN은 이전 단계에서 선택한 값이 고정되어 있습니다. 해당 값은 이전 단계에서만 수정 가능하며 수정 시 조회된 리소스 목록은 초기화됩니다.


1. 구독할 CloudWatch Log와 S3 bucket을 각각 선택하세요. 
:::note
복수 선택이 가능합니다.
:::
1. 필드를 모두 입력하면 ***등록*** 버튼이 활성화됩니다. 버튼을 누르면 선택한 리소스를 구독 목록에 등록합니다. 
1. 등록 성공 여부는 **IAM ROLE ARN 및 리전 입력** 단계와 같은 방식으로 표시됩니다.
<!-- 등록 성공-등록 실패 이미지 -->

<!--
1. 리소스를 선택한 후 순서대로 IAM Role ARN과 AWS Log ARN을 입력하세요. 페이지를 이탈하지 않은 경우 이전 단계에서 입력한 IAM Role ARN이 자동으로 입력되어 있습니다.
1. 두 ARN을 모두 입력하면 ***등록*** 버튼이 활성화 됩니다. 버튼을 누르면 선택한 리소스를 구독 목록에 등록합니다. 등록 성공 여부는 다음 이미지와 같이 메세지로 표시됩니다.
-->

## 모니터링 활성화

설치를 완료한 뒤 설치 페이지 하단에 ***모니터링 서비스 활성화*** 버튼을 클릭해 AWS Log 메뉴를 활성화하세요.

***모니터링 서비스 활성화*** 버튼을 클릭하면 다음과 같이 왼쪽 메뉴에 로그 메뉴가 활성화됩니다.