---
id: nodejs-set-agent-adv
title: Node.js 부가 기능
description: whatap.conf 파일로 설정할 수 있는 항목을 알아보세요.
tags: [ Java, whatap.conf ]
---

{@include: _agent-advanced-desc.mdx}

## 에이전트 이름 설정{#agentname}

Node.js 에이전트 이름 설정에 관한 자세한 설명은 [Node.js 모니터링 → 설정하기 → 환경설정](nodejs-set-agent#agentname)을 참조하세요.

* **whatap.okind**<span class='type'>String</span><br/>
에이전트가 속한 그룹 단위를 정의합니다.

* **auto_oname_enabled**<span class='type'>Boolean</span><br/>
    기본값 `false`<br/>
    서버에 등록할 에이전트 이름을 서버로부터 자동 부여받는 기능을 활성화합니다.

* **auto_oname_prefix**<span class='type'>String</span><br/>
    기본값 `agent`<br/>
    에이전트 이름을 서버로부터 자동 부여할 때 에이전트 이름의 prefix, 보통 업무명을 사용합니다. prefix 일련번호 '1~)'을 부여합니다.

* **auto_oname_reset**<span class='type'>Int</span><br/>
    기본값 `0`<br/>
    서버로부터 새로운 에이전트 이름을 부여받기 위해 수정합니다. 한번 정해진 에이전트 이름은 Node.js가 다시 시작할 때까지 유지합니다. 리셋을 원할 때 `auto_oname_reset` 값을 수정하세요. 현재 설정 값과 다른 값으로 변경하면 적용됩니다.

## 기능 제어

{@include: _nodejs-control-function.mdx}

## 통신

{@include: _common-network.mdx}

* **net_send_queue1_size**<span class='type'>Int</span><br/>
기본값 `512`<br/>프로파일 정보를 제외한 나머지 데이터 전송에 사용할 Queue의 크기를 설정합니다. 설정한 크기가 10 이하인 경우 10으로 설정합니다.

* **net_send_queue2_size**<span class='type'>Int</span><br/>
기본값 `1024`<br/>프로파일 정보 전송에 사용할 Queue의 크기를 설정합니다. 설정한 크기가 10 이하인 경우 10으로 설정합니다.

## 로그

* **log_rotation_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>에이전트 로그 파일을 날짜 별로 저장하는 기능을 활성화합니다. 로그 파일명은 *whatap-`yyyymmdd`.log* 형태로 저장합니다. 값이 `false`이면 로그 파일명은 *whatap.log* 형태로 저장합니다.

* **log_keep_days**<span class='type'>Int</span><br/>
기본값 `7`<br/>로그 파일 보관 기간을 설정합니다. `log_rotation_enabled` 옵션의 값이 `true`인 경우에만 동작합니다.

* **log_datasource_lookup_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>InitialContext Lookup 시 DataSource인 경우 로그를 기록하는 기능을 활성화합니다.

## 트랜잭션

### 트랜잭션 프로파일링

{@include: _transaction-profiling-common.mdx}

{@include: _transaction-profile-active-color.mdx}

* **hook_method_patterns**<span class='type'>String</span><br/>
    응답시간을 측정할 메소드를 설정합니다. 마지막 마침표(.)를 구분자로 클래스 FullName과 메소드로 구분되며 별표(*)를 와일드 카드로 사용할 수 있습니다. 대상이 여러 개인 경우 쉼표(,)로 구분합니다.

    ```ini title='예시'
    hook_method_patterns=a.b.C1.*
    ```

* **hook_method_access_public_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>메소드 프로파일을 설정할 때 public 메소드에 대해서만 별도 대상으로 처리할지 여부를 설정합니다.

* **hook_method_access_protected_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>메소드 프로파일을 설정할 때 protected 메소드에 대해서만 별도 대상으로 처리할지 여부를 설정합니다.

* **hook_method_access_private_enabled**<span class='type'>Boolean</span><br/>
기본값 `false`<br/>메소드 프로파일을 설정할 때 private 메소드에 대해서만 별도 대상으로 처리할지 여부를 설정합니다.

* **hook_method_access_none_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>메소드 프로파일을 설정할 때 no access indicated 메소드에 대해서만 별도 대상으로 처리할지 여부를 설정합니다.

* **hook_method_ignore_prefixes**<span class='type'>String</span><br/>
기본값 `get,set`<br/>메소드 프로파일을 설정할 때 프로파일에서 제외하고 싶은 클랙스들을 prefix로 설정합니다.

* **hook_method_ignore_classes**<span class='type'>String</span><br/>
메소드 프로파일을 설정할 때 프로파일에서 제외하고 싶은 클래스들을 설정합니다.

### HTTP 트랜잭션 추적

{@include: _transaction-trace-common.mdx}

{@include: _transaction-profile-http.mdx}

* **trace_ignore_url_set**<span class='type'>String</span><br/>
트랜잭션 추적에서 제외할 URL을 설정합니다.

* **trace_ignore_url_prefix**<span class='type'>String</span><br/>
트랜잭션 추적에서 제외할 URL prefix를 설정합니다.

### NON HTTP 트랜잭션 추적

* **hook_service_patterns**<span class='type'>String</span><br/>
NON-Http 트랜잭션 추적을 위한 시작점 패턴을 설정합니다.


* **trace_background_socket_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>소켓(TCP) 연결이 오픈될 때 트랜잭션을 시작한 상황에서만 오픈을 추적하는데 트랜잭션이 아닌 백그라운드 쓰레드에 의해 소켓이 오픈될 때도 추적합니다.

### 트랜잭션 추적

* **trace_service_port_enabled**<span class='type'>Boolean</span><br/>
기본값 `fasle`<br/>트랜잭션의 이름에 포트 번호를 추가합니다.

### 트랜잭션 연계 추적

* **mtrace_rate**<span class='type'>Int</span><br/>
기본값 `0`<br/>최초 트랜잭션이 발생할 때 발급하는 트랜잭션 연계 추적 기능(Multi Transaction ID, 이하 MTID)의 발급 비율을 설정하는 옵션입니다. `0`에서 `100`까지 설정할 수 있습니다. MTID를 추적하면 등록한 모든 애플리케이션 간의 호출을 확인할 수 있습니다. 같은 프로젝트에 속한 애플리케이션은 Caller & Callee 기능을 통해 트랜잭션의 프로파일을 바로 확인할 수 있습니다.

* **mtrace_spec**<span class='type'>String</span><br/>
기본값: `v1`<br/>현재 인스턴스의 애플리케이션 버전을 설정합니다. 임의의 문자열을 입력할 수 있습니다. 이 데이터는 호출 통계를 위해 이용합니다.

## DB, SQL

* **profile_connection_open_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>
프로파일 내역에 DBConnection 오픈 정보를 기록합니다.

* **profile_error_sql_time_max**<span class='type'>Int</span><br/>
기본값 `30000`<br/>
SQL 수행 시간이 설정한 값을 초과하면 TOO SLOW 에러로 처리합니다. `0`으로 설정하는 경우 에러 처리를 하지 않습니다.

* **trace_sql_normalize_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>
SQL 문에서 리터럴 부분을 추출해 SQL 문을 정규화하는 기능을 활성화합니다.

* **hook_connection_open_patterns**<span class='type'>String</span><br/>
    DB Connection Open 시 호출하는 메소드를 등록합니다. 미리 설정하지 않은 Connection Pool의 getConnection을 등록하는 것이 일반적입니다.

    ```ini title='예시'
    hook_connection_open_patterns=mypool.ConPool.getConnection
    ```

## HTTPC, API Call

* **hook_httpc_patterns**<span class='type'>String</span><br/>
HTTP Call을 수행하는 클래스를 설정합니다.

## 사용자 수

* **trace_user_enabled**<span class='type'>Boolean</span><br/>
기본값 `true`<br/>
실시간 사용자 집계 여부를 설정합니다. 사용자 추적 옵션이 중복 설정된 경우 동작 우선 순위는 다음과 같습니다.
>   1. **trace_user_using_ip**
>   1. **user_header_ticket**

{@include: _common-collect-user.mdx}

* **user_header_ticket_enabled**<span class='type'>Boolean</span><br/>
기본값 `false`<br/>
사용자 아이디를 http 헤더의 특정 값으로 구분하고 싶을 때 사용합니다. 모바일에서 접속할 때 전달되는 경우가 많습니다.

## 통계

* **mtrace_enabled**<span class='type'>Boolean</span><br/>
기본값 `false`<br/>트랜잭션 연계 추적 기능(Multi Transaction ID, 이하 MTID) 사용 여부를 설정합니다. MTID를 추적하면 등록한 모든 애플리케이션 간의 호출을 확인할 수 있습니다.

* **stat_domain_enabled**<span class='type'>Boolean</span><br/>
기본값 `false`<br/>
클라이언트의 접속 도메인별 트랜잭션 통계 수집 기능을 활성화합니다.

* **stat_mtrace_enabled**<span class='type'>Boolean</span><br/>
기본값 `false`<br/>
MSA 아키텍처에서 서비스 간의 호출 통계를 활성화합니다. 값이 `true`이면 외부 호출을 할 때 자신의 정보를 전송합니다.

## 토폴로지 맵

{@include: _common-topology-map.mdx}