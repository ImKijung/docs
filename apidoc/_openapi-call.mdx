Open API 호출 시에는 ACCOUNT API TOKEN 또는 프로젝트 코드와 PROJECT API TOKEN을 헤더로 전송합니다. 본 문서에서는 curl을 통한 호출 예시를 제공합니다.

## 메타성 정보 조회{#meta}

### 프로젝트 목록 조회

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/projects

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{ACCOUNT API TOKEN}}" "https://api.whatap.io/open/api/json/projects"
```

```json title='response'
{
  "data": [ {
        "groupName": "",
        "projectCode": 35,
        "projectName": "APM_TEST2",
        "createTime": "2018-10-19 07:17:03.774",
        "lastUpdatedTime": "2018-10-19 07:46:05.167",
        "status": "subscribe",
        "productType": "APM",
        "platform": "JAVA",
        "gatewayName": "LOCAL",
        "apiToken": "5**********************R"
    }, {
    }, (...)
  ],
  "accountEmail": "xxx@whatap.io",
  "total": 6
}
```

| Response Field  |           Field Type            | 설명                     |
| --------------- | :-----------------------------: | ------------------------ |
| gourpName       | <span class='api'>string</span> | 프로젝트 상위 그룹 이름  |
| projectCode     | <span class='api'>number</span> | 프로젝트 코드            |
| projectName     | <span class='api'>string</span> | 프로젝트 이름            |
| createTime      | <span class='api'>string</span> | 프로젝트 생성 날짜       |
| lastUpdatedTime | <span class='api'>string</span> | 프로젝트 수정 날짜       |
| status          | <span class='api'>string</span> | 프로젝트 상태            |
| productType     | <span class='api'>string</span> | 애플리케이션 서버 유형   |
| platform        | <span class='api'>string</span> | 애플리케이션 서버 플랫폼 |
| gatewayName     | <span class='api'>string</span> | 게이트웨이 이름          |
| apiToken        | <span class='api'>string</span> | PROJECT API TOKEN        |
| accountEmail    | <span class='api'>string</span> | 사용자 계정 이메일 주소  |
| total           | <span class='api'>number</span> | 프로젝트 수              |

### 프로젝트 정보 조회{#project-info}

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/projects

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/project"
```

```json title='response'
{
  "platform": "JAVA",
  "createTime": "Tue Sep 18 08:34:27 GMT 2018", "gatewayName": "Office-OTE",
  "projectCode": 1**1,
  "status": "Subscribe",
  "lastUpdatedTime": "Tue Sep 18 08:34:34 GMT 2018", "name": "SEO_APM",
  "productType": "APM"
}
```

| Response Field  |           Field Type            | 설명                     |
| --------------- | :-----------------------------: | ------------------------ |
| platform        | <span class='api'>string</span> | 애플리케이션 서버 플랫폼 |
| createTime      | <span class='api'>string</span> | 프로젝트 생성 날짜       |
| projectCode     | <span class='api'>number</span> | 프로젝트 코드            |
| status          | <span class='api'>string</span> | 프로젝트 상태            |
| lastUpdatedTime | <span class='api'>string</span> | 프로젝트 수정 날짜       |
| productType     | <span class='api'>string</span> | 애플리케이션 서버 유형   |

### 프로젝트 멤버 목록 조회

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/project/<code>projectCode</code>/members

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{ACCOUNT API TOKEN}}" "https://api.whatap.io/open/api/json/project/{{projectCode}}/members"
```

```json title='response'
{
  "data": [ {
      "email": "honggildong@whatap.io",
      "name": "홍길동",
      "typeKey": "super_admin",
      "typeName": "Super Admin"
    }, {
    }, (...)
      ],
  "total": 6
}
```

| Response Field |           Field Type            | 설명                    |
| -------------- | :-----------------------------: | ----------------------- |
| email          | <span class='api'>string</span> | 사용자 계정 이메일 주소 |
| name           | <span class='api'>string</span> | 사용자 계정 이름        |
| typeKey        | <span class='api'>string</span> | 사용자 권한             |
| typeName       | <span class='api'>string</span> | 사용자 권한 명칭        |
| total          | <span class='api'>number</span> | 프로젝트 멤버 수        |

### 그룹 목록 조회

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/groups

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{ACCOUNT API TOKEN}}" "https://api.whatap.io/open/api/json/groups"
```

```json title='response'
{
  "data": [ {
        "groupName": "WHATAP APM",
        "groupKey": "AB123KSKD*****2uasQ",
        "description": "APM Group"
    }, {
    }, (...)
  ],
  "total": 3
}
```

### 그룹 멤버 목록 조회

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/group/<code>groupKey</code>/members

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{ACCOUNT API TOKEN}}" "https://api.whatap.io/open/api/json/group/{{groupKey}}/members"
```

```json title='response'
{
  "data": [ {
      "groupName": "WHATAP APM",
      "groupKey": "AB123KSKD*****2uasQ",
      "description": "APM Group"
    }, {
    }, (...)
  ],
  "total": 3
}
```

### 그룹에 포함된 프로젝트 조회

<span class='apitype'>GET</span> https://api.whatap.io//open/api/json/group/<code>groupId</code>/projects

그룹에 포함된 프로젝트들의 메타정보를 조회하는 API 입니다. 계정의 API Token 이 필요하며 curl 을 사용한 예시 요청은 아래에 있습니다.

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{ACCOUNT API TOKEN}}" "https://api.whatap.io/open/api/json/group/{{groupId}}/projects" 
```

```json title='response'
{
  "data": [
    {
        "projectCode": 17,
        "createTime": null,
        "lastUpdatedTime": null,
        "deleteTime": null,
        "name": "test-proj",
        "status": "Subscribe",
        "productType": "APM",
        "platform": "JAVA",
        "gatewayName": "OFFICE-OTE"
    }
  ]
}
```

| Response Field  | Field Type      | 설명 |
| --------------- | :--: | --------------- |
| projectCode     | <span class='api'>number(integer)</span> | 프로젝트 코드|
| createTime      | <span class='api'>string</span> | 프로젝트 생성 날짜 |
| lastUpdatedTime | <span class='api'>string</span> | 프로젝트 업데이트 날짜 |
| deleteTime      | <span class='api'>string</span> | 프로젝트 삭제 날짜 |
| name            | <span class='api'>string</span> | 프로젝트 명 |
| status          | <span class='api'>string</span> | 프로젝트 상태 (`pending`, `trial`, `subscribe`, `close_pending`, `limited`, `closed`, `trial_limited`) |
| productType     | <span class='api'>string</span> | 프로젝트에 사용된 제품 |
| platform        | <span class='api'>string</span> | 프로젝트에 사용된 제품의 플랫폼 |
| gatewayName     | <span class='api'>string</span> | 데이터 서버 지역 |

## Spot 정보 조회{#spot}

### Active Agent

<span class='apitype'>GET</span> https://api.whatap.io/open/api/act_agent

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/act_agent"
```

```json title='response'
5 // 활성화 에이전트 개수
```

### Inactive Agent

<span class='apitype'>GET</span> https://api.whatap.io/open/api/inact_agent

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/inact_agent"
```

```json title='response'
1 // 비활성화 에이전트 개수
```

### HOST

<span class='apitype'>GET</span> https://api.whatap.io/open/api/host

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/host"
```

```json title='response'
2 // HOST 개수
```

### CPU Core

<span class='apitype'>GET</span> https://api.whatap.io/open/api/cpucore

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/cpucore"
```

```json title='response'
16 // CPU 코어 개수
```

### 트랜잭션 개수

<span class='apitype'>GET</span> https://api.whatap.io/open/api/txcount

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/txcount"
```

```json title='response'
469 // 트랜잭션 개수
```

### TPS

<span class='apitype'>GET</span> https://api.whatap.io/open/api/tps

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/tps"
```

```json title='response'
92.03 // 초당 처리된 트랜잭션 건수(Transaction per second, TPS)
```

### 액티브 사용자(5분)

<span class='apitype'>GET</span> https://api.whatap.io/open/api/user

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/user"
```

```json title='response'
1007 // 5분 동안 실시간 사용자 수
```

### 액티브 트랜잭션

<span class='apitype'>GET</span> https://api.whatap.io/open/api/actx

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/actx"
```

```json title='response'
171 // 액티브 트랜잭션 개수
```

### 평균 응답시간

<span class='apitype'>GET</span> https://api.whatap.io/open/api/rtime

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/rtime"
```

```json title='response'
1644 // 평균 응답시간
```

### 평균 CPU 사용률

<span class='apitype'>GET</span> https://api.whatap.io/open/api/cpu

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/cpu"
```

```json title='response'
9.26 // 평균 CPU 사용률
```

### 활성/비활성화 상태의 에이전트 정보

<span class='apitype'>GET</span> https://api.whatap.io/open/json/agents

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/json/agents"
```

```json title='response'
{
  "data": [
    {
      "host_ip": "127.0.0.1",
      "oname": "TC-0-1-8087",
      "active": true
    },
    {
      "host_ip": "127.0.0.1",
      "oname": "TC-0-1-8086",
      "active": true
    }
  ]
}
```

| Response Field |            Field Type            | 설명                                                       |
| -------------- | :------------------------------: | ---------------------------------------------------------- |
| host_ip        | <span class='api'>string</span>  | 에이전트가 위치한 host 의 ip 주소                          |
| oname          | <span class='api'>string</span>  | 에이전트 명                                                |
| active         | <span class='api'>boolean</span> | 에이전트 활성화 여부 (활성화 : `true`, 비활성화 : `false`) |

## 통계 데이터{#stat}

### Exception

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/exception/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/exception/1535554800000/1535641200000"
```

```json title='response'
{
  "records": [
    {
      "oids": "[-1459620666]",
      "time": 1535557500000,
      "classHash": -1811136020,
      "count": 14,
      "service": "/account/delete/dept/daegu",
      "class": "java.sql.SQLException(0)",
      "serviceHash": 1900616259,
      "snapSeq": "6068699991557528332",
      "msg": "Sql Exception"
    },
    (...)
  ],
  "total": 2063
}
```

### HTTP 외부 호출

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/httpc/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/httpc/1535554800000/1535641200000"
```

```json title='response'
{
  "records": [
    {
      "Sum": 22628,
      "Port": 10002,
      "Url": "/remote/account/save/employee/kwangju",
      "Host": "127.0.0.1",
      "Max": 1815,
      "Stdev": "247.95",
      "Actived": 0,
      "Avg": 1131,
      "HostHash": -675813464,
      "Min": 1002,
      "Error": 0,
      "Total": 20,
      "UrlHash": -243814510
    },
    (...)
  ],
  "total": 4923
}
```

호스트(host)가 127.0.0.1이면서 포트(port)가 1007인 HTTP 외부 호출 필터링

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/httpc/1543219200000/1543478400000/filter/host/127.0.0.1/port/10007"
```

```json title='response'
{
  "records": [
    {
      "Service": "/sales/remove/unit/kwangju",
      "Host": "127.0.0.1",
      "HostHash": -675813464,
      "Avg": 1080,
      "Error": 0,
      "Sum": 2411644,
      "Port": 10007,
      "Service_hash": -1003301916,
      "Url": "/remote/account/save/employee/seoul",
      "Max": 2442,
      "Stdev": "159.01",
      "UrlHash": 180997672,
      "Total": 2233,
      "Min": 1001
    },
    {
      "Service": "/product/delete/employee/daejun",
      "Host": "127.0.0.1",
      "HostHash": -675813464,
      "Avg": 1085,
      "Error": 0,
      "Sum": 2075036,
      "Port": 10007,
      "Service_hash": 2100205994,
      "Url": "/remote/account/save/employee/pusan",
      "Max": 2462,
      "Stdev": "173.06",
      "UrlHash": -924053750,
      "Total": 1911,
      "Min": 1001
    },
    (...)
  ],
  "total": 1080
}
```

### SQL

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/sql/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/sql/1535554800000/1535641200000"
```

```json title='response'
{
  "records": [
    {
      "time_max": 4164,
      "dbcHash": 450678784,
      "db": "jdbc:mysql://localhost:3306,localhost:3310/fake", "time_min": 0,
      "fetch_count": 0,
      "hash": 796628118,
      "fetch_time": 0,
      "sql_crud": 0,
      "count_total": 5224,
      "count_error": 0,
      "sql": "update table set x=# where key=#",
      "time_sum": 581391,
      "time_avg": 111,
      "time_std": "240.79",
      "count_actived": 0
    },
    (...)
  ],
  "total": 130
}
```

#### client IP

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/remote/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/remote/1535554800000/1535641200000"
```

```json title='response'
{
  "records": [
    {
      "count": 86,
      "city": "Winnipeg",
      "country": "CA (CANADA)",
      "ip": "140.193.83.68"
    },
    (...)
  ],
  "total": 1000
}
```

### 트랜잭션

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/transaction/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/transaction/1535554800000/1535641200000"
```

```json title='response'
{
  "records": [
    {
        "time_max": 44735,
        "sql_fetch_time": 363,
        "sql_time": 2628663,
        "count": 10743,
        "error": 29,
        "sql_count": 22635,
        "hash": -1485863373,
        "sql_fetch": 6741607,
        "httpc_avg": 1084,
        "cpu_avg": 0,
        "time_sum": 19911778,
        "time_avg": 1853,
        "httpc_count": 7072,
        "service": "/account/save/employee/seoul",
        "mem_avg": 0
    },
    (...)
  ],
  "total": 1080
}
```

### 에이전트 데이터 조회

* **Thread Count**
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_count/<code>stitme</code>/<code>etime</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_count/<code>stitme</code>/<code>etime</code>/<code>oids</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_count/<code>stitme</code>/<code>etime</code>/avg
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_count/<code>stitme</code>/<code>etime</code>/avg/<code>oids</code>

* **Thread Daemon Count**
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_daemon/<code>stitme</code>/<code>etime</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_daemon/<code>stitme</code>/<code>etime</code>/<code>oids</code> https://api.whatap.io/open/api/json/thread_daemon/<code>stitme</code>/<code>etime</code>/avg
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_daemon/<code>stitme</code>/<code>etime</code>/avg/<code>oids</code>

* **Thread Peak Count**
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_peak_count/<code>stitme</code>/<code>etime</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_peak_count/<code>stitme</code>/<code>etime</code>/<code>oids</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_peak_count/<code>stitme</code>/<code>etime</code>/avg
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/thread_peak_count/<code>stitme</code>/<code>etime</code>/avg/<code>oids</code>

* **Thread Pool Count**
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/threadpool_active/<code>stitme</code>/<code>etime</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/threadpool_active/<code>stitme</code>/<code>etime</code>/<code>oids</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/threadpool_active/<code>stitme</code>/<code>etime</code>/avg
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/threadpool_active/<code>stitme</code>/<code>etime</code>/avg/<code>oids</code>

* **Thread Pool Queue Count**
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/threadpool_queue/<code>stitme</code>/<code>etime</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/threadpool_queue/<code>stitme</code>/<code>etime</code>/<code>oids</code>
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/threadpool_queue/<code>stitme</code>/<code>etime</code>/avg
  * <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/threadpool_queue/<code>stitme</code>/<code>etime</code>/avg/<code>oids</code>

#### 에이전트 개별 데이터 조회 예시

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/thread_count/1536050100000/1536050700000"
```

```json title='response' {6,13} showLineNumbers
{
  "pcode": 1234570141,
  "type": "thread_count",
  "stime": 1536050100000,
  "etime": 1536050700000,
  "interval": 300, // data point 간격
  "data": [
    {
      "oname": "8080",
      "oid": -1234257485,
      "data": [
        [
          1536050100000, // 시계열 timestamp
          95.2
        ],
        [
          1536050400000,
          85.3
        ],
        [
          1536050700000,
          91.43
        ]
      ]
    },
    (...)
    {
      "oname": "TC-29-96-8082",
      "oid": 1482741919,
      "data": [
        [
          1536050100000,
          98.11
        ],
        [
          1536050400000,
          81.44
        ],
        [
          1536050700000,
          90.05
        ]
      ]
    }
  ]
}
```

#### 에이전트 평균 데이터 조회 예시

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/thread_count/1536050100000/1536050700000/avg"
```

```json title='response' {6,10-11} showLineNumbers
{
  "pcode": 1234570141,
  "type": "thread_count",
  "stime": 1536050100000,
  "etime": 1536050700000,
  "interval": 300, // data point 간격
  "op": "avg",
  "data": [
    [
      1536050100000, // 시계열 timestamp
      122.86 // 전체 에이전트 평균 데이터
    ],
    [
      1536050400000,
      99.26
    ],
    [
      1536050700000,
      109.68
    ]
  ]
}
```

#### 에이전트 지정 데이터 조회 예시

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/thread_count/1536050100000/1536050700000/-1050048219,- 1459620666"
```

```json title='response' {10,24} showLineNumbers
{
  "pcode": 1234570141,
  "type": "thread_count",
  "stime": 1536050100000,
  "etime": 1536050700000,
  "interval": 300,
  "data": [
    {
      "oname": "8081",
      "oid": -1050048219, // 지정한 에이전트 정보 조회
      "data": [
        [
          1536050100000,
          97.75
        ],
        [
          1536050400000,
          98
        ]
      ]
    },
    {
      "oname": "8073",
      "oid": -1459620666, // 지정한 에이전트 정보 조회
      "data": [
        [
          1536050100000,
          137.23
        ],
        [
          1536050400000
          102.53
        ],
        [
          1536050700000,
          120.2
        ]
      ]
    }
  ]
}
```

#### 에이전트 지정 평균 데이터 조회 예시

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/thread_count/1536050100000/1536050700000/avg/-1050048219,- 1459620666"
```

```json title='response' {11} showLineNumbers
{
  "pcode": 1234570141,
  "type": "thread_count",
  "stime": 1536050100000,
  "etime": 1536050700000,
  "interval": 300,
  "op": "avg",
  "data": [
    [
      1536050100000,
      117.49 // 지정한 에이전트들의 평균 지표 조회
    ],
    [
      1536050400000,
      100.26
    ],
    [
      1536050700000,
      120.2
    ]
  ]
}
```

### 액티브 사용자(5분  위)

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/visitor_5m/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/visitor_5m/1554444000000/1554076800000"
```

```json title='response' {4} showLineNumbers
{
  "data": [
    [
      1554444005000, // 1시간 단위 (5*60*1000)
      12
    ],
    [
      1554444010000,
      12
    ],
    (...)
  ],
  "pcode": 3000000079,
  "stime": 1554444000000,
  "etime": 1554444300000,
  "total": 59
}
```

### 액티브 사용자(1시간 단위)

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/visitor_h/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/visitor_h/1554444000000/1554454800000"
```

```json title='response' {4} showLineNumbers
{
  "data": [
    [
      1554444000000, // 1시간 단위 (60*60*1000)
      18
    ],
    [
      1554447600000,
      16
    ],
    (...)
  ],
  "pcode": 3000000079,
  "stime": 1554444000000,
  "etime": 1554454800000,
  "total": 3
}
```

### 프로젝트 간 트랜잭션 호출 통계

* <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/tx_caller/<code>stitme</code>/<code>etime</code>
* <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/tx_caller/<code>stitme</code>/<code>etime</code>/<code>oids</code>
* <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/tx_caller/<code>stitme</code>/<code>etime</code>/filter/<code>filterkey</code>/<code>filterval</code>
* <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/tx_caller/<code>stitme</code>/<code>etime</code>/<code>oids</code>/filter/<code>filterkey</code>/<code>filterval</code>

:::note
* **filterkey**: 조회 조건 키 (`caller_pcode`, `caller_spec` (버전), `caller_url`, `spec` (버전), `url`)
* **filterval**: 조회 조건 (`filterkey`가 `caller_url` 또는 `url`인 경우 base64로 인코딩)
:::

### 도메인 호출 통계

* <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/tx_domain/<code>stitme</code>/<code>etime</code>
* <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/tx_domain/<code>stitme</code>/<code>etime</code>/<code>oids</code>
* <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/tx_domain/<code>stitme</code>/<code>etime</code>/filter/<code>filterkey</code>/<code>filterval</code>
* <span class='apitype'>GET</span> https://api.whatap.io/open/api/json/tx_domain/<code>stitme</code>/<code>etime</code>/<code>oids</code>/filter/<code>filterkey</code>/<code>filterval</code>

:::note
* **filterkey**: 조회 조건 키 (`caller_pcode`, `caller_spec` (버전), `caller_url`, `spec` (버전), `url`)
* **filterval**: 조회 조건 (`filterkey`가 `caller_url` 또는 `url`인 경우 base64로 인코딩)
:::

## 장기 통계 {#long-stat}

### 액티브 사용자(1일 단위)

1일간 집계된 고유 사용자 통계로 `etime`은 `stime`을 기준으로 31일을 초과할 수 없습니다.

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/visitor_d/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/visitor_d/1554163200000/1554422400000"
```

```json title='response' {4} showLineNumbers
{
  "data": [
    [
      1554163200000, // 1일 단위 (24*60*60*1000)
      1007
    ],
    [
      1554249600000,
      1007
    ],
    [
      1554336000000,
      1007
    ]
  ],
  "pcode": 3000000079,
  "stime": 1554163200000,
  "etime": 1554422400000,
  "total": 3
}
```

### 액티브 사용자(1개월 단위)

1개월간 집계된 고유 사용자 통계로 `etime`은 `stime`을 기준으로 365일을 초과할 수 없습니다.

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/visitor_m/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/visitor_m/1551398400000/1554076800000"
```

```json title='response' {4} showLineNumbers
{
  "data": [
    {
      "stime": 1535760000000,  // 월 1일 시각 (24*60*60*1000)
      "etime": 1538352000000,
      "sdate": "Sat Sep 01 00:00:00 GMT 2018",
      "edate": "Mon Oct 01 00:00:00 GMT 2018",
      "mau": 1007
    },
    {
      "stime": 1538352000000,
      "etime": 1541030400000,
      "sdate": "Mon Oct 01 00:00:00 GMT 2018",
      "edate": "Thu Nov 01 00:00:00 GMT 2018",
      "mau": 1007
    }
  ],
  "pcode": 1234570141,
  "stime": 1535760000000,
  "etime": 1541030400000,
  "sdate": "Sat Sep 01 00:00:00 GMT 2018",
  "edate": "Thu Nov 01 00:00:00 GMT 2018",
  "total": 2
}
```

## 로그 데이터 조회

### Full GC Log

<span class='apitype'>GET</span> https://api.whatap.io/open/api/json/fullgclog/<code>stitme</code>/<code>etime</code>

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://api.whatap.io/open/api/json/fullgclog/1538983800000/1539104400000"
```

```json title='response'
{
  "pcode": 1,
  "stime": 1538983800000,
  "etime": 1539070200000,
  "data": [
    {
      "oid": 832254513,
      "oname": "SEO2",
      "count": [
        [
          1538983800000,
          1
        ]
      ], "logs": [
        "2018-10-08T16:33:09.001-0900: 79.812: [Full GC (System.gc()) 47269K->14801K(448000K), 0.0537298 secs]"
      ]
    },
    {
      "oid": -1453518268,
      "oname": "0-1-9780-seo",
      "count": [
        [
          1538983800000,
          2
        ]
      ],
      "logs": [
        "2018-10-08T16:32:57.009-0900: 32.382: [Full GC (System.gc()) 26874K->14816K(94720K), 0.0463841 secs]",
        "2018-10-08T16:33:02.435-0900: 37.807: [Full GC (System.gc()) 15040K->13556K(94720K), 0.0557387 secs]"
      ]
    }
  ]
}
```

## 단기 조회{#short-stat}

<span class='apitype'>GET</span> https://api.whatap.io/open/json/tag/db_pool_detail/dbconn

```bash title='command'
$ curl -L -w "\n" -H "x-whatap-token: {{PROJECT API TOKEN}}" -H "x-whatap-pcode: {{projectCode}}" "https://dev.whatap.io/open/api/json/tag/db_pool_detail/dbconn?etime=1667520000000"
```

```json title='response'
{
  "pcode": 17,
  "time": 1667467012037,
  "dbc_total": [
    {
      "oid": -959062357,
      "oname": "TC-0-1-8087",
      "databaseUrl": "jdbc:db:virtual",
      "active": 63,
      "idle": 37,
      "total": 100
    },
    {
      "oid": -1311576515,
      "oname": "TC-0-1-8086",
      "databaseUrl": "jdbc:db:virtual",
      "active": 10,
      "idle": 90,
      "total": 100
    }
  ]
}
```

| Response Field |           Field Type            | Description                             |
| -------------- | :-----------------------------: | --------------------------------------- |
| pcode          | <span class='api'>number</span> | 프로젝트 코드                           |
| time           | <span class='api'>number</span> | 조회 시간                               |
| dbc_total      | <span class='api'>array</span>  | 조회 결과                               |
| oid            | <span class='api'>number</span> | 에이전트 ID                             |
| oname          | <span class='api'>string</span> | 에이전트 명                             |
| databaseUrl    | <span class='api'>string</span> | 데이터베이스 URL                        |
| active         | <span class='api'>number</span> | 활성화 DB connection 수                 |
| idle           | <span class='api'>number</span> | 비활성화 DB connection 수               |
| total          | <span class='api'>number</span> | 총 DB connection 수 (`active` + `idle`) |