## 멀티 트랜잭션 

**멀티 트랜잭션**은 다른 APM과 연계된 트랜잭션을 의미합니다. 단일 APM에서 분리된 모든 트랜잭션을 수집하면 부하가 많이 걸리기 때문에 하나의 트랜잭션에 연계된 트랜잭션을 같이 수집합니다. **멀티 트랜잭션 연계 추적**은 와탭 프로젝트에 등록된 애플리케이션 서비스 간의 호출을 추적하는 것을 의미합니다.

1. 멀티 트랜잭션을 추적하려면 에이전트 설정 파일에 다음 옵션을 설정하세요.<br/>
  `mtrace_enabled`는 값이 `true`일 때 기본값 10% 비율로 멀티 트랜잭션을 추적합니다.  

  ```ini title='whatap.conf'
  mtrace_enabled=true 
  ```

1. 홈 화면 > 프로젝트 선택 > ***분석*** > ***히트맵*** 메뉴에서 차트 영역을 드래그하세요.<br/>
  드래그한 차트 영역의 트랜잭션 정보가 다음과 같이 하단 ***TX 트레이스*** 목록에 나타납니다. 목록에서 멀티 트랜잭션을 포함한 트랜잭션은 ![아이콘](/img/ic-s-mult-transation.svg) 아이콘이 표시됩니다.
  <!-- m 아이콘 확대 스크린샷 필요 -->
  ![mtrace_M](/img/tx-trace-table.png)

1. 해당 트레이스를 선택하면 ***통계*** 정보 창이 나타납니다.<br/>
  멀티 트랜잭션이 추적되는 경우 상단 요약 정보 탭의 ***멀티 트랜잭션***에서 **MTID** 값을 확인할 수 있습니다. 트랜잭션에서 외부 호출을 하는 경우에도 동일한 **MTID**가 생성됩니다. 업무별로 프로젝트가 분리되어 있더라도 처음 발급한 **MTID**를 통해 애플리케이션 간의 모든 트랜잭션을 확인할 수 있습니다. ***통계*** 창을 활용한 TX 트레이스 상세 분석에 관한 자세한 내용은 [다음 문서](trs-profile#details)를 참조하세요.

  ![mtrace_apm](/img/tx-trace-dt-up.png)

1. ***멀티 트랜잭션*** 옆의 ![오른쪽 화살표 아이콘](/img/ic-arrow-right.svg) 아이콘을 선택하면 ***분석*** > ***멀티 트랜잭션 추적*** 메뉴로 이동합니다.<br/>
  ***멀티 트랜잭션 추적*** 메뉴의 기본 화면은 ***차트 뷰***입니다. ***차트 뷰*** 탭에서는 동일한 **MTID**를 갖는 트랜잭션 서비스들의 개별 수행 시간을 확인할 수 있습니다.

  ![멀티 트랜잭션 차트](/img/multi-tx-cht.png)

  <!-- 
  ![mtrace-mtid](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring11.png) 
  ![mtrace-apm-tableview](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring12.png)
  ![mtrace-apm-13](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring13.png)
  -->

1. ***테이블 뷰*** 탭을 선택하세요.<br/>
  ***테이블 뷰*** 탭에서는 티어별 트랜잭션 트레이스 정보를 확인할 수 있습니다. 

  ![멀티 트랜잭션 테이블 뷰](/img/multi-tx-tb.png)

  ![상세 아이콘](/img/ic-pageview.svg)상세 아이콘을 선택하면 ***통계*** 창이 나타납니다. 같은 프로젝트에 속한 애플리케이션 서비스 간의 호출 관계를 확인할 수 있습니다. 

  ![멀티 트랜잭션 상세 보기](/img/multi-tx-stat.png)
  
:::note Caller와 Callee
* **Caller**: 서비스를 호출한 트랜잭션(호출자)을 의미합니다.
* **Callee**: 서비스를 호출 당한 트랜잭션(피호출자)을 의미합니다.
:::

## 참고 자료

* [멀티 트랜잭션 메뉴 추가](https://www.whatap.io/ko/blog/85/index.html)
* [멀티트랜잭션 다이어그램 개편](https://www.whatap.io/ko/blog/72/index.html)

<!-- 
 * ![왼쪽 아이콘](/img/ic-metrics-cube-back.svg) 아이콘을 선택하면 ***프로젝트 목록***을 숨기고 차트에 집중할 수 있도록 ***차트 뷰*** 영역을 확장시킬 수 있습니다.
 같은 프로젝트에 속한 애플리케이션 서비스들 간의 호출 관계는 트레이스 내에서 데이터를 확인할 수 있습니다.
-->

<!--
서비스(업무) 별로 분리되어 있는 애플리케이션 서비스들 간의 호출을 추적할 수 있습니다. 와탭에 등록되어 있는 프로젝트라면 프로젝트에 등록된 애플리케이션 서비스들 간의 호출에 대한 추적을 말합니다.
화면에서 멀티 트랜잭션 추적이 적용된 경우 히트맵 트랜잭션을 드래그하세요.

-->

