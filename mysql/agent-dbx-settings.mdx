---
id: agent-dbx-settings
title: DBX 에이전트 설정
description: whatap.conf 파일에 설정할 수 있는 옵션에 대해 안내합니다.
tags: [ MySQL, 데이터베이스 모니터링, DBX 에이전트 ]
---

DBX 에이전트에 필요한 설정은 *whatap.conf* 파일에 작성합니다. 설정할 수 있는 옵션은 다음을 참조하세요.

## 기본 옵션

{@include: ../common-items/_db-agent-dbx-basic-01.mdx}

* **dbms** <span class='type'>String</span>
  
  `mysql`

* **db_ip** <span class='type'>String</span>

  모니터링할 데이터베이스 서버의 IP 주소를 설정합니다.

* **db_port** <span class='type'>String</span>

  데이터베이스가 통신에 사용하는 포트를 설정합니다.


## 데이터 수집

* **deadlock_interval** <span class='type'>Int</span>

  기본값 `60`

  deadlock 정보를 가져오는 간격(단위: 분)을 설정합니다. deadlock 정보는 설정한 간격 동안 발생했던 가장 마지막의 deadlock 정보만을 가져옵니다.

* **long_run_session_sec** <span class='type'>Second</span>

  기본값 `10`

  설정한 시간보다 길게 수행되고 있는 세션을 long run 세션으로 처리합니다. (단위: 초)

* **tables_hour** <span class='type'>Int</span>

  기본값 `5`

  테이블 정보를 저장하기 위해 정보를 수집하는 시각을 설정합니다. 기본값으로 `5`이며 새벽 5시에 수집을 시작합니다.

* **tables_min_row** <span class='type'>Int</span>

  기본값 `10000`

  테이블 정보를 수집할 때 설정한 값보다 작은 row 수를 가진 테이블 정보는 수집하지 않습니다.

<!-- Oracle, Tibero 
* **tables_exclude_sys** <span class='type'>Boolean</span>

  기본값 `false`

  테이블 정보를 수집할 때 sys 소유인 테이블 정보의 수집 유무를 설정합니다. `true`로 설정하면 sys 소유의 테이블 정보는 수집하지 않습니다.
-->

* **replication_name** <span class='type'>String</span>

  replication 이름을 설정하면 동일한 `replication_name`을 갖는 DB 사이에 Master/Slave 관계가 있는 것으로 간주합니다.

* **skip_whatap_session** <span class='type'>Int</span>

  기본값 `0`

  `1`을 설정하면 와탭에서 수집하기 위한 query가 동작하는 세션을 active session list에 표시하지 않습니다.(기본값: 0)

<!-- MySQL 전용 -->

* **skip_sys_session** <span class='type'>Int</span>

  기본값 `1`

  `2`를 설정하면 sys 세션(root,system user,event_scheduler)이 active session에서 보이지 않습니다. `1`을 설정하면 sys 세션이 보이지만 total runtime에서는 제외합니다.

<!-- -->

<!-- Redis
* **idle_as_active** <span class='type'>Second</span>

  기본값 `1`

  세션이 마지막 active 상태였던 이후로 idle 상태를 유지한 시간(초)이 설정값보다 작은 세션들을 active session으로 간주하는 옵션입니다. 예를 들어 설정값이 1이면, 1초 이내에 active였던 세션들이 액티브 세션 창에 나타납니다.
-->

## AWS RDS CloudWatch 적용{#using-aws-rds}

{@include: ../common-items/_db-agent-aws.mdx}

<!-- AES 256 암호화 적용 -->
{@include: ../common-items/_db-aes-256-encrypt.mdx}  

## 에이전트 이름 식별{#naming}

<details>
<summary>에이전트 이름 설정</summary>
와탭 모니터링 서비스에서 모니터링 대상을 포괄적인 의미로 오브젝트라는 명칭을 사용하며 에이전트와 혼용해서 사용하기도 합니다. 모니터링 대상 즉 오브젝트를 구분하기 위해서는 이름을 구분해야 합니다. 와탭은 오브젝트 이름과 오브젝트 아이디를 통해서 대상을 구분합니다.

:::note

* 오브젝트(에이전트) 이름은 프로젝트 단위로 유일해야 합니다.
* 오브젝트 아이디 = CRC32(오브젝트 이름)입니다. 오브젝트 아이디 또는 이름이 바뀌면 이전 데이터와 연결되지 않습니다.

:::

와탭은 모니터링 정보 수집 대상인 데이터베이스 서버 식별을 위한 정보로 기본적으로 데이터베이스 서버로부터 수집한 정보를 활용합니다. 기본 활용 정보는 데이터베이스 서버의 종류, IP 주소, 서비스 포트 등을 조합해 데이터베이스 서버를 고유 식별자로 사용합니다. 필요에 따라 사용자가 설정한 명칭을 이용하거나 패턴을 변경해 고유한 값으로 변경해 이용합니다. 에이전트의 이름은 반드시 고유한 값이어야 합니다.

데이터베이스 서버로부터 추출한 정보를 활용하는 이유는 데이터베이스 서버 정지 또는 네트워크 단절, 에이전트 문제로 인한 수집 서버와 에이전트의 통신 두절 상태가 복구되었을 경우, 재접속된 에이전트로부터 송신되는 정보가 기존 에이전트로부터 송신된 정보와의 연속성을 유지하기 위해서입니다.
</details>

{@include: ../common-items/_db-agent-dbx-naming.mdx}